@inherits LayoutComponentBase
@inject AuthenticationStateProvider AuthProvider
@inject NavigationManager NavManager

<AuthorizeView>
    <Authorized>
        <div class="internal-page">
            <nav class="internal-nav">
                <div class="nav-brand">
                    CIO Dashboard
                </div>
                <div class="nav-links">
                    <NavLink class="nav-link" href="dashboard">Kalender</NavLink>
                    <NavLink class="nav-link" href="sales">Sales</NavLink>

                    <AuthorizeView Roles="Admin" Context="adminContext">
                        <Authorized>
                            <NavLink class="nav-link" href="users">Brugerstyring</NavLink>
                        </Authorized>
                    </AuthorizeView>

                    <button class="nav-link logout-button" @onclick="HandleLogout">Log Ud</button>
                </div>
            </nav>

            <main class="internal-content">
                @Body
            </main>
        </div>
    </Authorized>

    <NotAuthorized>
        <RedirectToLogin />
    </NotAuthorized>
</AuthorizeView>

@code {
    private void HandleLogout()
    {
        var authProvider = (CustomAuthStateProvider)AuthProvider;
        authProvider.Logout();

        NavManager.NavigateTo("/login", forceLoad: true);
    }
}